generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

enum TaskStatus {
    PENDING
    RUNNING
    COMPLETED
    FAILED
}

model ResearchTask {
    id        String        @id @default(cuid())
    topic     String
    status    TaskStatus    @default(PENDING)
    createdAt DateTime      @default(now())
    updatedAt DateTime      @updatedAt
    // results
    summary   Json?
    articles  Json? // array of Article
    keywords  String[]
    // relations
    logs      ResearchLog[]
}

model ResearchLog {
    id        String       @id @default(cuid())
    taskId    String
    task      ResearchTask @relation(fields: [taskId], references: [id], onDelete: Cascade)
    step      Int
    label     String
    message   String
    payload   Json?
    createdAt DateTime     @default(now())
}
